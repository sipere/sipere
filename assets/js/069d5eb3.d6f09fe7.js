"use strict";(globalThis.webpackChunksiperweb=globalThis.webpackChunksiperweb||[]).push([[241],{644:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"migrations/migration","title":"Migrations","description":"Generate migration file","source":"@site/docs/4_migrations/migration.md","sourceDirName":"4_migrations","slug":"/migrations/migration","permalink":"/sipere/docs/migrations/migration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Migrations and seeders","permalink":"/sipere/docs/category/migrations-and-seeders"},"next":{"title":"Migrations","permalink":"/sipere/docs/migrations/seeder"}}');var a=i(4848),t=i(8453);const s={sidebar_position:1},o="Migrations",l={},c=[{value:"Generate migration file",id:"generate-migration-file",level:2},{value:"Writer migration",id:"writer-migration",level:2},{value:"Run migration",id:"run-migration",level:2},{value:"Reset migration",id:"reset-migration",level:2},{value:"Rollback migration",id:"rollback-migration",level:2},{value:"Fresh migration",id:"fresh-migration",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"migrations",children:"Migrations"})}),"\n",(0,a.jsx)(n.h2,{id:"generate-migration-file",children:"Generate migration file"}),"\n",(0,a.jsx)(n.p,{children:"Generate new migrations file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op make:migration <migration_name>\n"})}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op make:migration employee\n"})}),"\n",(0,a.jsx)(n.p,{children:"Pissible file name:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"2025_12_13_112951_create_employee.js"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"writer-migration",children:"Writer migration"}),"\n",(0,a.jsx)(n.p,{children:"The migration file"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:"import { DataTypes } from 'sequelize';\n\nasync function up({context: QueryInterface}) {\n  await QueryInterface.createTable('employees', {\n    id: {\n      allowNull: false,\n      autoIncrement: true,\n      primaryKey: true,\n      type: DataTypes.INTEGER\n    },\n    name: {\n      type: DataTypes.STRING\n    },\n    createdAt: { type: DataTypes.DATE },\n    updatedAt: { type: DataTypes.DATE }    \n  });\n}\n\nasync function down({context: QueryInterface}) {\n  await QueryInterface.dropTable('employees');\n}\n\nexport { up, down }\n"})}),"\n",(0,a.jsx)(n.h2,{id:"run-migration",children:"Run migration"}),"\n",(0,a.jsx)(n.p,{children:"We can run all migrations at once, or a specific migration."}),"\n",(0,a.jsx)(n.p,{children:"Run all migrations:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op migrate\n"})}),"\n",(0,a.jsx)(n.p,{children:"Run a single migration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op migrate <migration_filename>\n"})}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op migrate 2025_12_13_112951_create_employee.js\n"})}),"\n",(0,a.jsx)(n.h2,{id:"reset-migration",children:"Reset migration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op migrate:reset\n"})}),"\n",(0,a.jsx)(n.p,{children:"The reset will undo all migrations."}),"\n",(0,a.jsx)(n.h2,{id:"rollback-migration",children:"Rollback migration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op migrate:rollback\n"})}),"\n",(0,a.jsx)(n.p,{children:"Rollback undoes the last migration."}),"\n",(0,a.jsx)(n.h2,{id:"fresh-migration",children:"Fresh migration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"node op migrate:fresh\n"})}),"\n",(0,a.jsx)(n.p,{children:"Fresh undoes all migrations and then redoes all migrations."})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>o});var r=i(6540);const a={},t=r.createContext(a);function s(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);